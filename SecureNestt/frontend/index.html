<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SecureNestt</title>
    <!-- Replace your <style> ... </style> block with this upgraded CSS -->
  
  <style>
    * {
      box-sizing: border-box;
      font-family: 'Segoe UI', 'Roboto', Arial, sans-serif;
    }
    body {
      margin: 0;
      background: linear-gradient(135deg, #e0eafc 0%, #cfdef3 100%);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .container {
      width: 370px;
      background: #fff;
      padding: 2.2rem 2rem 1.5rem 2rem;
      box-shadow: 0 8px 32px rgba(52, 152, 219, 0.13), 0 1.5px 6px rgba(0,0,0,0.07);
      border-radius: 18px;
      position: absolute;
      transition: all 0.3s cubic-bezier(.4,2,.6,1);
      animation: fadeIn 0.7s;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(30px);}
      to { opacity: 1; transform: translateY(0);}
    }
    h2 {
      text-align: center;
      margin-bottom: 1.2rem;
      color: #2980b9;
      letter-spacing: 1px;
      font-weight: 600;
    }
    input {
      width: 100%;
      padding: 0.85rem;
      margin: 0.6rem 0;
      border: 1.5px solid #d6e6f3;
      border-radius: 7px;
      font-size: 1rem;
      background: #f8fbff;
      transition: border 0.2s;
    }
    input:focus {
      border: 1.5px solid #3498db;
      outline: none;
      background: #f0f8ff;
    }
    button {
      width: 100%;
      padding: 0.85rem;
      background: linear-gradient(90deg, #3498db 60%, #6dd5fa 100%);
      color: white;
      border: none;
      border-radius: 7px;
      margin-top: 1rem;
      cursor: pointer;
      font-size: 1.05rem;
      font-weight: 500;
      box-shadow: 0 2px 8px rgba(52,152,219,0.07);
      transition: background 0.3s, transform 0.15s;
    }
    button:hover, button:focus-visible {
      background: linear-gradient(90deg, #2980b9 60%, #57c1eb 100%);
      transform: translateY(-2px) scale(1.03);
    }
    .toggle-link {
      text-align: center;
      margin-top: 1.1rem;
      color: #3498db;
      cursor: pointer;
      font-size: 1rem;
      text-decoration: underline;
      transition: color 0.2s;
    }
    .toggle-link:hover {
      color: #2980b9;
    }
    .hidden {
      display: none;
    }
    /* Consent & Policy styles */
    .consent-label {
      display: flex;
      align-items: center;
      gap: 7px;
      font-size: 0.98rem;
      margin: 12px 0 0 0;
      color: #555;
    }
    .consent-label input[type="checkbox"] {
      accent-color: #3498db;
      width: 18px;
      height: 18px;
      vertical-align: middle;
    }
    #consent-btn, #consent-btn2 {
      margin: 0 2px;
      padding: 0 2px;
      font-size: inherit;
      background: none;
      border: none;
      color: #3498db;
      cursor: pointer;
      text-decoration: underline;
      border-radius: 3px;
      transition: background 0.2s, color 0.2s;
    }
    #consent-btn:hover, #consent-btn2:hover {
      background: #eaf6ff;
      color: #217dbb;
    }
    /* Google login button style */
    #google-login-btn {
      background: #fff;
      color: #444;
      border: 1.5px solid #d6e6f3;
      padding: 10px 0;
      border-radius: 6px;
      display: flex;
      align-items: center;
      gap: 10px;
      justify-content: center;
      width: 100%;
      cursor: pointer;
      margin-top: 10px;
      margin-bottom: 0.5rem;
      font-size: 1.07rem;
      font-weight: 500;
      box-shadow: 0 1.5px 6px rgba(66,133,244,0.08);
      transition: box-shadow 0.2s, border 0.2s;
    }
    #google-login-btn:hover {
      box-shadow: 0 4px 16px rgba(66,133,244,0.13);
      border: 1.5px solid #57c1eb;
      background: #f5faff;
    }
    #google-login-btn img {
      width: 22px;
      height: 22px;
      vertical-align: middle;
    }
    /* Forgot password modal */
    #forgot-modal {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100vw; height: 100vh;
      background: rgba(0,0,0,0.18);
      justify-content: center;
      align-items: center;
      z-index: 1000;
      animation: fadeIn 0.3s;
    }
    #forgot-modal > div {
      background: #fff;
      padding: 2rem 1.5rem;
      border-radius: 10px;
      box-shadow: 0 2px 16px rgba(0,0,0,0.13);
      min-width: 280px;
      max-width: 90vw;
      animation: fadeIn 0.4s;
    }
    #forgot-modal input {
      background: #f8fbff;
      border: 1.5px solid #d6e6f3;
      border-radius: 6px;
      padding: 0.7rem;
      margin-bottom: 1rem;
      font-size: 1rem;
      width: 100%;
    }
    #forgot-modal button {
      margin-top: 0.5rem;
      font-size: 1rem;
      border-radius: 6px;
    }
    /* Responsive */
    @media (max-width: 500px) {
      .container {
        width: 97vw;
        padding: 1.2rem 0.5rem 1rem 0.5rem;
        border-radius: 0;
        min-height: 100vh;
        box-shadow: none;
      }
      #forgot-modal > div {
        min-width: 90vw;
        padding: 1.2rem 0.7rem;
      }
    }
  </style>
</head>
<body>

<!-- SIGNUP -->
<div class="container" id="signup-container">
  <h2>Sign Up</h2>
  <input type="text" id="signup-name" placeholder="Full Name" />
  <input type="email" id="signup-email" placeholder="Email" />
  <input type="password" id="signup-password" placeholder="Password" />
  <input type="password" id="signup-confirm" placeholder="Confirm Password" />
  <button onclick="signup()">Sign Up</button>
  <label class="consent-label">
    <input type="checkbox" id="consent-agree" />
    I agree to the <button type="button" id="consent-btn">Consent & Policy</button>
  </label>
  <div class="toggle-link" onclick="showLogin()">Already have an account? Login</div>
</div>

<!-- LOGIN -->
<div class="container hidden" id="login-container">
  <h2>Login</h2>
  <input type="email" id="login-email" placeholder="Email" />
  <input type="password" id="login-password" placeholder="Password" />
  <button onclick="login()">Login</button>
  <label class="consent-label">
    <input type="checkbox" id="consent-agree2" />
    I agree to the <button type="button" id="consent-btn2">Consent & Policy</button>
  </label>
  <div style="text-align:center; margin: 12px 0;">
    <button type="button" id="google-login-btn">
      <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google">
      <span>Login with Google</span>
    </button>
  </div>

  <div class="toggle-link" onclick="showSignup()">Don't have an account? Sign Up</div>
    <div class="toggle-link" id="forgot-link" style="color:#e67e22;cursor:pointer;">Forgot Password?</div>
</div>
<div id="forgot-modal" style="display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.2);justify-content:center;align-items:center;z-index:1000;">
  <div style="background:#fff;padding:2rem 1.5rem;border-radius:8px;box-shadow:0 2px 16px rgba(0,0,0,0.15);min-width:280px;max-width:90vw;">
    <h3 style="margin-top:0;">Reset Password</h3>
    <input type="email" id="forgot-email" placeholder="Enter your email" style="width:100%;margin-bottom:1rem;" />
    <button id="forgot-send-btn" style="width:100%;">Send Reset Link</button>
    <button id="forgot-cancel-btn" style="width:100%;background:#eee;color:#333;margin-top:0.5rem;">Cancel</button>
  </div>
</div>

<script>
    
    // Show login page by default on page load
    window.onload = function() {
      showLogin();
    };
  
    
  // Forgot password modal logic
  const forgotLink = document.getElementById('forgot-link');
  const forgotModal = document.getElementById('forgot-modal');
  const forgotSendBtn = document.getElementById('forgot-send-btn');
  const forgotCancelBtn = document.getElementById('forgot-cancel-btn');
  const forgotEmail = document.getElementById('forgot-email');
  
  forgotLink.onclick = function() {
    forgotModal.style.display = "flex";
    forgotEmail.value = "";
  };
  
  forgotCancelBtn.onclick = function() {
    forgotModal.style.display = "none";
  };
  
  forgotSendBtn.onclick = function() {
    const email = forgotEmail.value.trim();
    if (!email) {
      alert("Please enter your email.");
      return;
    }

 fetch("http://localhost:8000/forgot-password"
, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ email })
    })
      .then(res => res.json())
      .then(data => {
        alert(data.message || "If the email exists, a reset link has been sent.");
        forgotModal.style.display = "none";
      })
      .catch(() => {
        alert("Something went wrong. Please try again.");
        forgotModal.style.display = "none";
      });
  };
  // ...existing code...
  // Consent alert
  document.getElementById("consent-btn").onclick = function() {
    alert("By using this app, you AGREE to our Privacy Policy and Terms of Service.\n\nIf you misuse the app, the company will NOT be responsible for any consequences. Use at your own risk.");
  };
  document.getElementById("consent-btn2").onclick = function() {
    alert("By using this app, you AGREE to our Privacy Policy and Terms of Service.\n\nIf you misuse the app, the company will NOT be responsible for any consequences. Use at your own risk.");
  };

  // Google login demo handler
  document.getElementById("google-login-btn").onclick = function() {
    alert("Google Login coming soon!");
    // Yahan par Google OAuth ka code add kar sakte hain
  };

  // Disable signup/login button until agree is checked
  const signupBtn = document.querySelector('#signup-container button[onclick="signup()"]');
  const loginBtn = document.querySelector('#login-container button[onclick="login()"]');
  const consentAgree = document.getElementById('consent-agree');
  const consentAgree2 = document.getElementById('consent-agree2');

  signupBtn.disabled = true;
  loginBtn.disabled = true;

  consentAgree.addEventListener('change', function() {
    signupBtn.disabled = !this.checked;
  });
  consentAgree2.addEventListener('change', function() {
    loginBtn.disabled = !this.checked;
  });

  function showLogin() {
    document.getElementById("signup-container").classList.add("hidden");
    document.getElementById("login-container").classList.remove("hidden");
  }

  function showSignup() {
    document.getElementById("login-container").classList.add("hidden");
    document.getElementById("signup-container").classList.remove("hidden");
  }

  function isValidEmail(email) {
    return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
  }

  function signup() {
    if (!document.getElementById('consent-agree').checked) {
      alert("You must agree to the Consent & Policy to sign up.");
      return;
    }
    const name = document.getElementById("signup-name").value.trim();
    const email = document.getElementById("signup-email").value.trim();
    const password = document.getElementById("signup-password").value;
    const confirm = document.getElementById("signup-confirm").value;

    if (!name || !email || !password || !confirm) {
      alert("Please fill in all fields.");
      return;
    }
    if (!isValidEmail(email)) {
      alert("Invalid email.");
      return;
    }
    if (password !== confirm) {
      alert("Passwords do not match.");
      return;
    }

    const payload = {
      email,
      password,
      username: name,
      flat_number: "N/A",
      full_address: "N/A"
    };

  
     fetch("http://localhost:8000/signup"
, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(payload)
    })
      .then(res => res.json())
      .then(data => {
        if (data.detail) throw new Error(data.detail);
        alert("Signup successful.");
        showLogin();
      })
      .catch(err => alert(err.message));
  }

  function login() {
    if (!document.getElementById('consent-agree2').checked) {
      alert("You must agree to the Consent & Policy to login.");
      return;
    }
    const email = document.getElementById("login-email").value.trim();
    const password = document.getElementById("login-password").value;

    if (!email || !password) {
      alert("Enter email and password.");
      return;
    }

 fetch("http://localhost:8000/login"
, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ email, password })
    })
      .then(res => res.json())
      .then(data => {
        if (data.detail) throw new Error(data.detail);
        const token = data.access_token;
        localStorage.setItem('securenesttCurrentUser', email);
        localStorage.setItem('securenesttToken', token);
        alert("Login successful!");
        window.location.href = "home.html";
      })
      .catch(err => alert(err.message));
  }
</script>

</body>
</html>

